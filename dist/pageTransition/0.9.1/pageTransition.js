define("#pageTransition/0.9.1/pageTransition",["events","$"],function(a,b,c){function g(a){this.options=e.extend({},f,a),this._prevPages=[],this._step=0,this._DATAATTRIBUTENAMESPACE="data-pageTransition"}var d=a("events"),e=a("$"),f={element:null};d.mixTo(g),g.prototype.transition=function(a){this.nextPage=e(a);if(this.getPage()&&this.getPage()[0]===this.nextPage.get(0))return;this._nextPageParent=this.nextPage.parent(),this._transitionForward()},g.prototype.back=function(){this._transitionBack()},g.prototype.getPage=function(){return this.page},g.prototype.render=function(){this._insertPageViewport(),this.sync(),this.bindUI()},g.prototype.sync=function(){var a=e(this.options.element),b=a.css("width"),c=this.viewport.find("*["+this._DATAATTRIBUTENAMESPACE+"-role=page]");this.viewport.css({width:parseInt(b,10)*c.length}),a.css({overflow:"hidden"}),c.css({"float":"left",width:b}).show()},g.prototype.bindUI=function(){var a=this._DATAATTRIBUTENAMESPACE,b=this.viewport.find("*["+a+"-role=trigger]");b.unbind("click.pageTransition").bind("click.pageTransition",e.proxy(function(b){b.preventDefault();var c=e(b.currentTarget).attr(""+a+"-action");switch(c){case"forward":this.nextPage=e(e(b.currentTarget).attr(""+a+"-forward")),this._nextPageParent=this.nextPage.parent(),this._transitionForward();break;case"back":this._transitionBack()}},this))},g.prototype.destroy=function(){var a=this._DATAATTRIBUTENAMESPACE,b=this.viewport.find("*["+a+"-role=trigger]");b.unbind("click.pageTransition"),e(this.options.element).attr("style",null).append(this._originPage.attr("style",null)),this.page.removeAttr("style").appendTo(this._nextPageParent).hide(),this.viewport.remove(),this._step=0,this._prevPages=[],this.page=null,this.nextPage=null,this.viewport=null,this._nextPageParent=null,this._originPage=null},g.prototype._transitionForward=function(){this.trigger("transitionStart","forward",this.page,this),this.nextPage.appendTo(this.viewport),this.sync(),this.viewport.animate({marginLeft:-parseInt(e(this.options.element).css("width"),10)},300,null,e.proxy(function(){this.__transitionForwardEnd()},this))},g.prototype.__transitionForwardEnd=function(){this.page.appendTo(this._nextPageParent).hide(),this.bindUI(),this.trigger("transitionEnd","forward",this.nextPage,this),this._prevPages.push(this.page),this._step++,this.page=this.nextPage,this.viewport.css({marginLeft:0}),this.sync()},g.prototype._transitionBack=function(){if(this._step<=0)return;this.trigger("transitionStart","back",this.page,this),this.viewport.prepend(this._prevPages[this._step-1]),this.sync(),this.viewport.css({marginLeft:-parseInt(e(this.options.element).css("width"),10)}),this.viewport.animate({marginLeft:0},300,null,e.proxy(function(){this._transitionBackEnd()},this))},g.prototype._transitionBackEnd=function(){this.page.appendTo(this._nextPageParent).hide(),this.bindUI();var a=this._prevPages[this._step-1]||this._originPage;this.trigger("transitionEnd","back",a,this),this.nextPage=this.page,this.page=this._prevPages[this._step-1],this.viewport.css({marginLeft:0}),this._prevPages.splice(this._step-1),this._step--,this.sync()},g.prototype._insertPageViewport=function(){var a=this._DATAATTRIBUTENAMESPACE,b=e(this.options.element),c=e("<div "+a+'-role="viewport"></div>'),d=e(b.find("*["+a+"-role=page]")[0]);d.wrapAll(c),this.viewport=e(c,b),this.page=d,this._originPage=d},c.exports=g});