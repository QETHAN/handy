define("#parser/0.9.0/parser",["#events/0.9.1/events"],function(e,t,n){function w(e,t,n,r){(!n||!t)&&S('The module "'+e+'" not has data!',"error"),E(new t(n),e+"_"+r),b++,b===a.length&&(y=(new Date).getTime(),f.time={parseDOM:d-p,analyzeData:m-v,parse:y-g},h.trigger("completed",h,f))}function E(e,t){if(c)return;if(typeof window.HandyParserData!="object"){S("window.HandyParserData is not object! "+s+" can't saves data!","error"),c=!0;return}if(f[t]){S("HandyParserData."+t+" already exist","warn");return}e.render?e.render():S("HandyParserData."+t+" can't calling render method.","warn"),f[t]=e}function S(e,t){t||(t="log"),console[t](e)}function x(e){var t=arguments[1],n=arguments[2],r={parseBoolean:!0,parseFunction:!0,parseNull:!0,parseObject:!0,parseNumber:!0,parse:undefined},s=document.createElement("div"),o=s.dataset?!0:!1,u={},a=r;if(n)for(k in n)a[k]=n[k];var f=function(t){var n=t,r=t.charAt?t.charAt(0):"";if(t==="null")a.parseNull?n=null:n;else if(r==="{"||r==="["){if(!window.JSON)var i="Your browser does not supportthe primary JSON.Is IE?";try{a.parseObject?n=JSON.parse(t):"";for(var s in n)n[s]=f(n[s])}catch(o){var i="The "+t+" may be illegal JSON string! Happened in "+e+"."}}else if(t==="true"||t==="false"){if(a.parseNull)switch(t){case"true":n=!0;break;case"false":n=!1}}else isNaN(t*1)||(a.parseNumber?n=t*1:n);return n};switch(o){case!0:var c=e.dataset;for(i in c)value=f(c[i]),u[i]=value;break;case!1:var h=e.attributes,p="";function d(e){var t="";for(j=1,nameL=e.length;j<nameL;j++)j!==1?t+=e[j].charAt(0).toUpperCase()+e[j].slice(1).toLowerCase():t+=e[j];return t}for(i=0,l=h.length;i<l;i++){p=h[i].name.split("-");var p=d(p);p&&p.length>0?u[p]=f(h[i].value):""}}return e.nodeType>0?u:null}function T(e){return e!=="script"&&e!=="textarea"&&e!=="input"&&e!=="button"&&e!=="br"&&e!=="embed"&&e!=="select"&&e!=="option"&&e!=="pre"&&e!=="code"&&e!=="iframe"&&e!=="img"&&e!=="map"&&e!=="style"&&e!=="video"&&e!=="audio"&&e!=="canvas"?e:!1}function N(e){var t=["parent"],n=e;return t.forEach(function(t){if(t.toLowerCase()===e.toLowerCase())return n=t,!1}),n}function C(e,t){function r(e){var t=0;return fieldset.forEach(function(n){n.toLowerCase()===e.toLowerCase()&&t++}),t}function i(e,n){for(var i in e){var s=i.split(t.toLowerCase()),o="";if(!s||!s[1])return!1;o=s[1].toLowerCase(),o&&(o=N(o));if(r(o)===1)result.moduleData[o]=e[i];else if(r(o)>1)if(result.moduleData[o])if(document.querySelector(e[i]))result.moduleData[o].push(e[i]);else if(result.moduleData[o][e[i]]){var u=result.moduleData[o][e[i]];u.push(n)}else result.moduleData[o][e[i]]=[n];else document.querySelector(e[i])?(result.moduleData[o]=[],result.moduleData[o].push(e[i])):(result.moduleData[o]={},result.moduleData[o][e[i]]=[n])}}var n=e.element;return elements=n.querySelectorAll("*"),result={moduleName:t,moduleId:e.id,moduleData:{element:n}},fieldset=[],elements=Array.prototype.slice.call(elements,0),elements.forEach(function(e){var n=T(e.nodeName.toLowerCase());if(n){var r=x(e);for(var i in r){var s=i.split(t.toLowerCase()),o="";if(!s||!s[1])return!1;o=s[1].toLowerCase(),fieldset.push(o)}}}),elements.forEach(function(e){var t=T(e.nodeName.toLowerCase());if(t){var n=x(e);i(n,e)}}),result}var r=e("#events/0.9.1/events"),s="HandyParser",o=.1,u={},a=[],f={},c=!1,h=window.HandyParser={};r.mixTo(h);var p=null,d=null,v=null,m=null,g=null,y=null;window.HandyParserData=f,h.parseDOM=function(){var e=document.querySelector("body").querySelectorAll("*[data-module-name]");Array.prototype.slice.call(e,0).forEach(function(e){var t=T(e.nodeName.toLowerCase());if(t){var n=x(e).moduleName,r={element:e,id:x(e)[""+n.toLowerCase()+"Id"]};if(!r.id){var i='The module "'+n+"'s\" id is "+(r.id!==undefined?r.id:"undefined")+".";S(i,"warn")}u[n]?u[n].push(r):u[n]=[r]}})},h.analyzeData=function(){for(var e in u){var t=u[e];t.forEach(function(t){a.push(C(t,e))})}},h.loadModules=function(){if(!a)return S("The parsedData is null!","error");if(!(a instanceof Array))return S("The parsedData must be Array!","error");a.forEach(function(t,n){var r=t.moduleName,i=t.moduleData;r&&e.async(r,function(e){e&&w(r,e,i,t.moduleId)})})},h.start=function(){g=(new Date).getTime(),p=(new Date).getTime(),h.parseDOM(),d=(new Date).getTime(),v=(new Date).getTime(),h.analyzeData(),m=(new Date).getTime(),h.loadModules()};var b=0;n.exports=h});